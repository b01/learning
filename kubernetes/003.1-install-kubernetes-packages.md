# Install Kubernetes Packages

Follow along with the steps listed here if you want practice upgrading an
older version to a newer version which is also on the exam.

Or for installing the latest version of Kubernetes review the documentation at
[Installing kubeadm, kubelet and kubectl].

1. Download the public signing key, add the appropriate `apt` repository for Kubernetes, and then install the packages: 
   ```shell
   KUBE_VER="v1.34"
   curl -fsSL https://pkgs.k8s.io/core:/stable:/${KUBE_VER}/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
   cat <<TXT | sudo tee /etc/apt/sources.list.d/kubernetes.list
   deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/${KUBE_VER}/deb/ /
   TXT
   sudo apt-get update
   sudo apt-get install -y kubelet kubeadm kubectl
   sudo apt-mark hold kubelet kubeadm kubectl
   ```
2. Make a shortcut alias for `kubectl` on 'control-plane-01` machine:
   ```shell
   cp ~/.bashrc bashrc.bak
   echo "alias k='kubectl'" | tee -a ~/.bashrc
   alias k='kubectl'
   ```
   NOTE: We make a backup of the .bashrc file.
3. Add auto complete for `kubectl` and the shortcut `k`
   ```shell
   kubectl completion bash | tee -a ~/.bashrc
   echo "complete -o default -F __start_kubectl k" | tee -a ~/.bashrc
   source <(kubectl completion bash)
   complete -o default -F __start_kubectl k
   ```
4. Make a config for `critctl`
   You can use this tools to check the status and logs of static Pods.
5. See
   ```shell
   cat <<TXT | sudo tee -a /etc/crictl.yaml
   runtime-endpoint: unix:///var/run/containerd/containerd.sock
   image-endpoint: unix:///var/run/containerd/containerd.sock
   timeout: 10
   debug: true
   TXT
   ```

   NOTE: For help see [Debugging Kubernetes nodes with crictl] or
   the raw URL is https://kubernetes.io/docs/tasks/debug/debug-cluster/crictl/
   You can also search for that title in the official documentation.

## References

* [Installing kubeadm] - These steps are the same steps, just streamlined a bit.
* [kubectl Quick Reference] - 

Next: [Manual Cluster Install] or [kubeadm Cluster Install]

---

[Installing kubeadm]: https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/
[Manual Cluster Install]: /kubernetes/004.0-manual-cluster-install.md
[kubeadm Cluster Install]: /kubernetes/005.0-kubeadm-cluster-install.md
[kubectl Quick Reference]: https://kubernetes.io/docs/reference/kubectl/quick-reference/
[General usage]: https://kubernetes.io/docs/tasks/debug/debug-cluster/crictl/#general-usage
[Installing kubeadm, kubelet and kubectl]: https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#installing-kubeadm-kubelet-and-kubectl
[Debugging Kubernetes nodes with crictl]: https://kubernetes.io/docs/tasks/debug/debug-cluster/crictl/